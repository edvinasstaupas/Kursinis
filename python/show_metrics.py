import numpy as np
import matplotlib.pyplot as plt


# training_1/checkpoints/resnet-similarity-gldv/train_second/cp-0018.ckpt
# matrix/resnet-similarity-gldv/matrix.npy
RNT = (
    "RNT",
    np.array(
        [
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262302e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22262035e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22257047e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22239145e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22215453e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22183211e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22140191e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22092184e-01],
            [4.50679136e-04, 3.95528835e-03, 1.22032866e-01],
            [4.50679136e-04, 3.95528835e-03, 1.21921977e-01],
            [4.50679136e-04, 3.95528835e-03, 1.21707326e-01],
            [4.50679136e-04, 3.95528835e-03, 1.21303496e-01],
            [4.50679136e-04, 3.95528835e-03, 1.20642619e-01],
            [4.50679136e-04, 3.95528835e-03, 1.19559296e-01],
            [4.50679136e-04, 3.95528835e-03, 1.17937475e-01],
            [4.50679136e-04, 3.95528835e-03, 1.15595814e-01],
            [4.50679136e-04, 3.95528835e-03, 1.12393320e-01],
            [4.50679136e-04, 3.95484302e-03, 1.08293120e-01],
            [4.50679136e-04, 3.95457582e-03, 1.03111824e-01],
            [4.50679136e-04, 3.95315075e-03, 9.69390336e-02],
            [4.50679136e-04, 3.94976620e-03, 8.99319528e-02],
            [4.50679136e-04, 3.94433311e-03, 8.23969717e-02],
            [4.50590069e-04, 3.93195279e-03, 7.48535293e-02],
            [4.49877533e-04, 3.90443108e-03, 6.75152973e-02],
            [4.48897796e-04, 3.84831886e-03, 6.03347139e-02],
            [4.47205522e-04, 3.74286350e-03, 5.34762859e-02],
            [4.41950568e-04, 3.57327989e-03, 4.70548208e-02],
            [4.29035849e-04, 3.30545536e-03, 4.11724783e-02],
            [4.07392563e-04, 2.94829659e-03, 3.60686707e-02],
            [3.61968381e-04, 2.48470274e-03, 3.15928746e-02],
            [3.04520151e-04, 1.97319083e-03, 2.78004008e-02],
            [2.28100646e-04, 1.41803607e-03, 2.44629704e-02],
            [1.35470942e-04, 9.08483634e-04, 2.02985527e-02],
            [3.91894901e-06, 3.91894901e-06, 3.91894901e-06],
        ]
    ),
    "GLDv2-Test",
)

# resnet stock
# matrix/resnet-similarity-gldv-stock/matrix.npy
RN = (
    "RN",
    np.array(
        [
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02269161e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02268893e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02267825e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02262391e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02250991e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02211712e-01],
            [1.28176353e-03, 9.86773547e-03, 2.02098419e-01],
            [1.28176353e-03, 9.86773547e-03, 2.01838878e-01],
            [1.28176353e-03, 9.86773547e-03, 2.01340281e-01],
            [1.28176353e-03, 9.86773547e-03, 2.00331062e-01],
            [1.28176353e-03, 9.86764640e-03, 1.98488622e-01],
            [1.28176353e-03, 9.86746827e-03, 1.95466221e-01],
            [1.28176353e-03, 9.86693387e-03, 1.90996927e-01],
            [1.28176353e-03, 9.86568693e-03, 1.84930929e-01],
            [1.28167446e-03, 9.86150078e-03, 1.77151815e-01],
            [1.28149633e-03, 9.85393008e-03, 1.67648987e-01],
            [1.28114006e-03, 9.83629481e-03, 1.56722690e-01],
            [1.28024939e-03, 9.80138054e-03, 1.44283589e-01],
            [1.27918058e-03, 9.73529281e-03, 1.30707994e-01],
            [1.27668671e-03, 9.62084168e-03, 1.16689824e-01],
            [1.27196615e-03, 9.44110443e-03, 1.02686618e-01],
            [1.26288132e-03, 9.18610554e-03, 8.93058116e-02],
            [1.24693832e-03, 8.87570697e-03, 7.66524159e-02],
            [1.22538410e-03, 8.47472723e-03, 6.47610777e-02],
            [1.19260744e-03, 7.99581385e-03, 5.37835671e-02],
            [1.15128034e-03, 7.43709642e-03, 4.40081942e-02],
            [1.09988867e-03, 6.79955466e-03, 3.54979292e-02],
            [1.02792251e-03, 6.08425740e-03, 2.82144734e-02],
            [9.51948341e-04, 5.34535738e-03, 2.21511467e-02],
            [8.65375195e-04, 4.59354264e-03, 1.70623914e-02],
            [7.67935872e-04, 3.86871521e-03, 1.29446448e-02],
            [6.68448007e-04, 3.17871298e-03, 9.60855043e-03],
            [5.69672679e-04, 2.54419951e-03, 6.94455578e-03],
            [4.64217324e-04, 1.96659987e-03, 4.89156090e-03],
            [3.71142285e-04, 1.47040748e-03, 3.33556001e-03],
            [2.83054999e-04, 1.04261857e-03, 2.16842574e-03],
            [2.06279225e-04, 6.93208640e-04, 1.34402138e-03],
            [1.44377644e-04, 4.42395903e-04, 7.89311957e-04],
            [9.95769316e-05, 2.66844801e-04, 4.06680027e-04],
            [6.08327767e-05, 1.42150969e-04, 1.61923848e-04],
            [3.25985304e-05, 4.66711200e-05, 4.66711200e-05],
            [8.63950122e-06, 9.08483634e-06, 9.08483634e-06],
            [3.91894901e-06, 3.91894901e-06, 3.91894901e-06],
        ]
    ),
    "GLDv2-Test",
)

# resnet quad
# training_1/checkpoints/resnet-similarity-gldv_quad/cp-0014.ckpt
# matrix/resnet-similarity-gldv-quad_v2/matrix.npy
# Recalls:
RNQR = (
    "RNQR",
    np.array(
        [
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737119e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38737030e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38736317e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38735248e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38733378e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38724115e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38697039e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38643064e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38536273e-01],
            [4.94232910e-04, 4.37354709e-03, 1.38343353e-01],
            [4.94232910e-04, 4.37354709e-03, 1.37987887e-01],
            [4.94232910e-04, 4.37354709e-03, 1.37415542e-01],
            [4.94232910e-04, 4.37354709e-03, 1.36548208e-01],
            [4.94232910e-04, 4.37354709e-03, 1.35294767e-01],
            [4.94232910e-04, 4.37345803e-03, 1.33621020e-01],
            [4.94232910e-04, 4.37292363e-03, 1.31353997e-01],
            [4.94232910e-04, 4.37230016e-03, 1.28452371e-01],
            [4.94232910e-04, 4.37114228e-03, 1.24839902e-01],
            [4.93965709e-04, 4.36793587e-03, 1.20574037e-01],
            [4.93787575e-04, 4.36268092e-03, 1.15645780e-01],
            [4.93609441e-04, 4.35413048e-03, 1.10239412e-01],
            [4.93253173e-04, 4.33560454e-03, 1.04333378e-01],
            [4.92718771e-04, 4.30603429e-03, 9.79528835e-02],
            [4.91115564e-04, 4.25116900e-03, 9.10753952e-02],
            [4.88977956e-04, 4.16815854e-03, 8.35386328e-02],
            [4.83723002e-04, 4.04132710e-03, 7.52475618e-02],
            [4.74905366e-04, 3.85971944e-03, 6.64474727e-02],
            [4.58695168e-04, 3.61558673e-03, 5.69928301e-02],
            [4.31084391e-04, 3.30768203e-03, 4.74499221e-02],
            [3.89668225e-04, 2.90429748e-03, 3.74810955e-02],
            [3.24025829e-04, 2.28367847e-03, 2.72155867e-02],
            [2.13137386e-04, 1.35497662e-03, 1.59001559e-02],
            [3.91894901e-06, 3.91894901e-06, 3.91894901e-06],
        ]
    ),
    "GLDv2-Test",
)

# vit stock
# matrix/vit-gldv-similarity-stock/matrix.npy
# Recalls:
ViT = (
    "ViT",
    np.array(
        [
            [1.41037631e-03, 1.13172122e-02, 2.38425295e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38425295e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38425295e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38425295e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38425295e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38425295e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38425295e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38422089e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38403741e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38355110e-01],
            [1.41037631e-03, 1.13172122e-02, 2.38204587e-01],
            [1.41037631e-03, 1.13172122e-02, 2.37885638e-01],
            [1.41037631e-03, 1.13172122e-02, 2.37277399e-01],
            [1.41037631e-03, 1.13172122e-02, 2.36051035e-01],
            [1.41037631e-03, 1.13171231e-02, 2.33920196e-01],
            [1.41037631e-03, 1.13150746e-02, 2.30624805e-01],
            [1.41037631e-03, 1.13124916e-02, 2.26012469e-01],
            [1.41028724e-03, 1.13049210e-02, 2.20057983e-01],
            [1.41002004e-03, 1.12935204e-02, 2.12657047e-01],
            [1.40975284e-03, 1.12711646e-02, 2.03887063e-01],
            [1.40930750e-03, 1.12297484e-02, 1.93555021e-01],
            [1.40770430e-03, 1.11633044e-02, 1.81570430e-01],
            [1.40547762e-03, 1.10623914e-02, 1.67974972e-01],
            [1.39968827e-03, 1.09147183e-02, 1.52845157e-01],
            [1.39185037e-03, 1.07108439e-02, 1.36708083e-01],
            [1.38169673e-03, 1.04401692e-02, 1.20133690e-01],
            [1.36361612e-03, 1.01098196e-02, 1.03802360e-01],
            [1.33912269e-03, 9.69832999e-03, 8.84004453e-02],
            [1.30741483e-03, 9.22663104e-03, 7.47150301e-02],
            [1.26510799e-03, 8.68697395e-03, 6.24007125e-02],
            [1.20953017e-03, 8.06956134e-03, 5.15651748e-02],
            [1.14932086e-03, 7.43878869e-03, 4.21121354e-02],
            [1.08154086e-03, 6.74905366e-03, 3.39283010e-02],
            [1.00369628e-03, 6.01344912e-03, 2.69406368e-02],
            [9.23001559e-04, 5.26484079e-03, 2.10558005e-02],
            [8.36606546e-04, 4.51872634e-03, 1.61010020e-02],
            [7.37564017e-04, 3.81723447e-03, 1.20439991e-02],
            [6.45824983e-04, 3.15733690e-03, 8.79732799e-03],
            [5.56134491e-04, 2.55702516e-03, 6.23308840e-03],
            [4.68047206e-04, 2.00285014e-03, 4.25134714e-03],
            [3.80761523e-04, 1.49089290e-03, 2.76125585e-03],
            [2.95435315e-04, 1.06657760e-03, 1.70634603e-03],
            [2.21776887e-04, 7.25450902e-04, 9.97194389e-04],
            [1.63794255e-04, 4.61010911e-04, 5.49899800e-04],
            [1.11422846e-04, 2.68269873e-04, 2.87330216e-04],
            [7.81117791e-05, 1.52037408e-04, 1.53551548e-04],
            [5.10354041e-05, 7.92696504e-05, 7.92696504e-05],
            [3.13515921e-05, 3.97238922e-05, 3.97238922e-05],
            [1.56757960e-05, 1.78134046e-05, 1.78134046e-05],
            [5.96749054e-06, 6.05655756e-06, 6.05655756e-06],
            [3.91894901e-06, 3.91894901e-06, 3.91894901e-06],
        ]
    ),
    "GLDv2-Test",
)

# vit
# training_1/checkpoints/vit-gldv-similarity/cp-0010.ckpt
# matrix/vit-gldv-similarity/matrix.npy
ViTT = (
    "ViTT",
    np.array(
        [
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03605264],
            [0.00038459, 0.00167722, 0.03601585],
            [0.00038459, 0.00167722, 0.0359902],
            [0.00038459, 0.00167722, 0.03597738],
            [0.00038459, 0.00167722, 0.03595956],
            [0.00038459, 0.00167722, 0.03584965],
            [0.00036339, 0.00125299, 0.00196785],
        ]
    ),
    "GLDv2-Test",
)

# matrix/resnet-similarity-gldv-filtered/matrix.npy
# training_1/checkpoints/resnet-similarity-gldv-filtered/cp-0100.ckpt
RNF = (
    "RNF",
    np.array(
        [
            [4.33578268e-04, 3.79799599e-03, 1.16958183e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16958183e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16958183e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16958183e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16958183e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16958183e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16958183e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16951859e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16937430e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16932799e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16927188e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16914273e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16907237e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16892452e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16863059e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16825829e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16779693e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16726876e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16662481e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16568604e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16454776e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16345313e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16222489e-01],
            [4.33578268e-04, 3.79799599e-03, 1.16066711e-01],
            [4.33578268e-04, 3.79799599e-03, 1.15849744e-01],
            [4.33578268e-04, 3.79799599e-03, 1.15527767e-01],
            [4.33578268e-04, 3.79799599e-03, 1.15033623e-01],
            [4.33578268e-04, 3.79799599e-03, 1.14177332e-01],
            [4.33578268e-04, 3.79799599e-03, 1.12899399e-01],
            [4.33578268e-04, 3.79799599e-03, 1.10976798e-01],
            [4.33578268e-04, 3.79799599e-03, 1.08318771e-01],
            [4.33578268e-04, 3.79799599e-03, 1.04892006e-01],
            [4.33578268e-04, 3.79790692e-03, 1.00683589e-01],
            [4.33578268e-04, 3.79790692e-03, 9.58673792e-02],
            [4.33578268e-04, 3.79755066e-03, 9.06897350e-02],
            [4.33578268e-04, 3.79514585e-03, 8.52626141e-02],
            [4.33578268e-04, 3.79104876e-03, 7.97547985e-02],
            [4.33311067e-04, 3.77964819e-03, 7.42364729e-02],
            [4.33043866e-04, 3.76361612e-03, 6.89195279e-02],
            [4.32153195e-04, 3.73360053e-03, 6.37236250e-02],
            [4.30639056e-04, 3.67205522e-03, 5.88788243e-02],
            [4.27788911e-04, 3.57221109e-03, 5.42416388e-02],
            [4.22266756e-04, 3.42925852e-03, 4.98068136e-02],
            [4.13003785e-04, 3.22903585e-03, 4.54720107e-02],
            [3.96615453e-04, 2.95417502e-03, 4.11030951e-02],
            [3.72300156e-04, 2.66951681e-03, 3.67440659e-02],
            [3.33556001e-04, 2.34388778e-03, 3.22117123e-02],
            [2.86617680e-04, 1.99536851e-03, 2.70078824e-02],
            [2.33444667e-04, 1.57862391e-03, 2.09080383e-02],
            [1.63081719e-04, 1.06515253e-03, 1.25076820e-02],
            [3.91894901e-06, 3.91894901e-06, 3.91894901e-06],
        ]
    ),
    "GLDv2-Test",
)


# matrix/numbers-similarity/matrix.npy
# training_1/checkpoints/resnet-numbers-similarity/cp-0009.ckpt
RNN = (
    "RNN",
    np.array(
        [
            [0.00110988, 0.01108897, 0.98100235],
            [0.00110988, 0.01108897, 0.98100235],
            [0.00110988, 0.01108897, 0.98100235],
            [0.00110988, 0.01108897, 0.98100235],
            [0.00110988, 0.01108897, 0.98100235],
            [0.00110988, 0.01108897, 0.98100235],
            [0.00110988, 0.01108897, 0.98099543],
            [0.00110988, 0.01108897, 0.98092195],
            [0.00110988, 0.01108897, 0.98078908],
            [0.00110988, 0.01108897, 0.98075071],
            [0.00110988, 0.01108897, 0.98063558],
            [0.00110988, 0.01108897, 0.98050447],
            [0.00110988, 0.01108897, 0.98040243],
            [0.00110988, 0.01108897, 0.98033272],
            [0.00110988, 0.01108897, 0.98030077],
            [0.00110988, 0.01108897, 0.98029422],
            [0.00110988, 0.01108897, 0.98029234],
            [0.00110988, 0.01108897, 0.98029057],
            [0.00110988, 0.01108897, 0.98028768],
            [0.00110988, 0.01108897, 0.98028491],
            [0.00110988, 0.01108897, 0.98026881],
            [0.00110988, 0.01108897, 0.98019092],
            [0.00110988, 0.01108897, 0.9800992],
            [0.00110988, 0.01108897, 0.98005881],
            [0.00110988, 0.01108897, 0.979992],
            [0.00110988, 0.01108897, 0.97982994],
            [0.00110988, 0.01108897, 0.97967354],
            [0.00110988, 0.01108897, 0.97952557],
            [0.00110988, 0.01108897, 0.97933458],
            [0.00110988, 0.01108897, 0.97898529],
            [0.00110988, 0.01108897, 0.97884903],
            [0.00110988, 0.01108897, 0.97869804],
            [0.00110988, 0.01108897, 0.97859273],
            [0.00110988, 0.01108897, 0.97857285],
            [0.00110988, 0.01108884, 0.97856077],
            [0.00110988, 0.01108859, 0.978385],
            [0.00110988, 0.01108809, 0.97800212],
            [0.00110988, 0.01108771, 0.97763736],
            [0.00110988, 0.01108758, 0.97729412],
            [0.00110988, 0.01108695, 0.97706047],
            [0.00110988, 0.01108582, 0.97678114],
            [0.00110988, 0.01108494, 0.97647137],
            [0.00110988, 0.01108368, 0.97594643],
            [0.00110988, 0.01108154, 0.97551134],
            [0.00110988, 0.01107978, 0.97493784],
            [0.00110988, 0.01107865, 0.97403998],
            [0.0011095, 0.01107425, 0.97287801],
            [0.00110912, 0.01106997, 0.97152403],
            [0.00110912, 0.01106217, 0.96832979],
            [0.00110724, 0.01104241, 0.95929285],
            [0, 0, 0],
        ]
    ),
    "MNIST-Test",
)

# training_1/checkpoints/vit-numbers-similarity/cp-0093.ckpt
# matrix/vit-numbers-similarity/matrix.npy
ViTN = (
    "ViTN",
    np.array(
        [
            [0.00109616, 0.01097157, 0.96258046],
            [0.00109616, 0.01097157, 0.96258046],
            [0.00109616, 0.01097157, 0.96258021],
            [0.00109616, 0.01097157, 0.96249641],
            [0.00109616, 0.01097157, 0.96246785],
            [0.00109616, 0.01097157, 0.96246068],
            [0.00109616, 0.01097157, 0.96242042],
            [0.00109616, 0.01097157, 0.96231649],
            [0.00109616, 0.01097157, 0.96222338],
            [0.00109616, 0.01097157, 0.96215179],
            [0.00109616, 0.01097157, 0.9621075],
            [0.00109616, 0.01097157, 0.96203402],
            [0.00109616, 0.01097157, 0.96197262],
            [0.00109616, 0.01097157, 0.96182792],
            [0.00109616, 0.01097157, 0.96177797],
            [0.00109616, 0.01097157, 0.96157275],
            [0.00109616, 0.01097157, 0.96131205],
            [0.00109616, 0.01097157, 0.96111187],
            [0.00109616, 0.01097157, 0.96100668],
            [0.00109616, 0.01097157, 0.96085632],
            [0.00109616, 0.01097157, 0.9606701],
            [0.00109616, 0.01097157, 0.96055623],
            [0.00109616, 0.01097157, 0.96053837],
            [0.00109616, 0.01097157, 0.96043356],
            [0.00109616, 0.01097157, 0.96005685],
            [0.00109616, 0.01097157, 0.9598388],
            [0.00109616, 0.01097157, 0.95974015],
            [0.00109616, 0.01097157, 0.95970857],
            [0.00109616, 0.01097157, 0.95927058],
            [0.00109616, 0.01097157, 0.95888481],
            [0.00109616, 0.01097157, 0.95832566],
            [0.00109616, 0.01097132, 0.95760432],
            [0.00109616, 0.0109712, 0.95728033],
            [0.00109616, 0.01097069, 0.95643556],
            [0.00109616, 0.01097057, 0.95559758],
            [0.00109616, 0.01097006, 0.95454873],
            [0.00109616, 0.01096918, 0.95369565],
            [0.00109616, 0.01096793, 0.95295858],
            [0.00109616, 0.01096377, 0.95171206],
            [0.00109604, 0.01095937, 0.95051361],
            [0.00109604, 0.01095635, 0.94942373],
            [0.00109591, 0.01095031, 0.94862325],
            [0.00109566, 0.01094352, 0.94731999],
            [0.00109566, 0.01093735, 0.94532948],
            [0.00109528, 0.01092804, 0.9428611],
            [0.00109478, 0.01091823, 0.93978248],
            [0.00109453, 0.01090615, 0.93677734],
            [0.00109289, 0.01088501, 0.9323416],
            [0.0010905, 0.01085884, 0.92505297],
            [0.0010871, 0.01080801, 0.91214235],
            [0, 0, 0],
        ]
    ),
    "MNIST-Test",
)

# vit gldv quad
# training_1/checkpoints/vit-similarity-gldv_quad/cp-0040.ckpt
# matrix/vit-gldv-similarity-quad/matrix.npy
ViTQR = (
    "ViTQR",
    np.array(
        [
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199305277221048],
            [9.610331774660234e-05, 0.0007199287463815919, 0.0319928746381646],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199278557114167],
            [9.610331774660234e-05, 0.0007199287463815919, 0.0319926074370958],
            [9.610331774660234e-05, 0.0007199287463815919, 0.031991805833889386],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03199091516366004],
            [9.610331774660234e-05, 0.0007199287463815919, 0.031987530616788516],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03198183032732069],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03197595190380698],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03196615453128417],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03195430861723387],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03194103763081659],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03192660877310117],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03191057670897292],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03189605878423455],
            [9.610331774660234e-05, 0.0007199287463815919, 0.031875217100867846],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03185499888666167],
            [9.610331774660234e-05, 0.0007199287463815919, 0.031830861723446326],
            [9.610331774660234e-05, 0.0007199287463815919, 0.0318023602761072],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03176860387441492],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03172816744600252],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03167748830995272],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03162404809619187],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03155867290135779],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03147655310621201],
            [9.610331774660234e-05, 0.0007199287463815919, 0.03136806947227743],
            [9.610331774660234e-05, 0.0007198396793586571, 0.031205165887329828],
            [9.610331774660234e-05, 0.0007197506123357223, 0.030956312625250178],
            [9.610331774660234e-05, 0.000718949009129309, 0.030151324871965916],
            [2.324649298597196e-05, 2.4048096192384788e-05, 2.4048096192384788e-05],
        ]
    ),
    "GLDv2-Test",
)

# training_1/checkpoints/resnet-similarity-gldv-small-class/cp-0090.ckpt
# matrix/resnet-similarity-gldv-small-class-e100/matrix.npy
RNS = (
    "RNS",
    np.array(
        [
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68594077e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68593186e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68590514e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68581608e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68569138e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68560232e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68545090e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68532621e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68521042e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68508573e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68497885e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68480071e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68459586e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68424850e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68392786e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68355377e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68317969e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68266310e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68203963e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68149633e-02],
            [1.70118014e-04, 1.44324204e-03, 4.68089958e-02],
            [1.70118014e-04, 1.44315297e-03, 4.68001781e-02],
            [1.70118014e-04, 1.44315297e-03, 4.67847695e-02],
            [1.70118014e-04, 1.44306391e-03, 4.67526163e-02],
            [1.70118014e-04, 1.44279670e-03, 4.66800267e-02],
            [1.70118014e-04, 1.44252950e-03, 4.65802717e-02],
            [1.70028947e-04, 1.44172790e-03, 4.63807615e-02],
            [1.69761746e-04, 1.43549321e-03, 4.56960143e-02],
            [3.91894901e-06, 3.91894901e-06, 3.91894901e-06],
        ]
    ),
    "GLDv2-Test",
)


# matrix/resnet-similarity-gldv-quad_clean-dataset/matrix.npy
# training_1/checkpoints/resnet-similarity-gldv_quad_clean/cp-0030.ckpt
RNQRC = (
    "RNQR",
    np.array(
        [
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.05399897959183015],
            [0.0029336734693878844, 0.01829285714285532, 0.053997959183666885],
            [0.0029336734693878844, 0.01829285714285532, 0.05399693877550362],
            [0.0029336734693878844, 0.01829285714285532, 0.05399489795917709],
            [0.0029336734693878844, 0.01829285714285532, 0.05399387755101383],
            [0.0029336734693878844, 0.01829285714285532, 0.05399285714285056],
            [0.0029336734693878844, 0.01829285714285532, 0.05398979591836077],
            [0.0029336734693878844, 0.01829285714285532, 0.053985714285707705],
            [0.0029336734693878844, 0.01829285714285532, 0.05397551020407507],
            [0.0029336734693878844, 0.01829285714285532, 0.05395612244897302],
            [0.0029336734693878844, 0.018289795918365524, 0.053916326530605685],
            [0.0029336734693878844, 0.01828877551020226, 0.053859183673462825],
            [0.0029326530612246186, 0.018285714285712466, 0.053755102040809785],
            [0.0029326530612246186, 0.018281632653059404, 0.053561224489789436],
            [0.0029326530612246186, 0.018269387755100223, 0.053272448979585385],
            [0.0029316326530613532, 0.018253061224487978, 0.05279693877550383],
            [0.0029316326530613532, 0.018210204081630845, 0.05214081632652435],
            [0.002928571428571557, 0.018117346938773725, 0.051104081632646986],
            [0.0029255102040817607, 0.017977551020406397, 0.04974795918366756],
            [0.0029224489795919646, 0.017745918367345216, 0.04796122448979028],
            [0.0029051020408164523, 0.017294897959181994, 0.045466326530606914],
            [0.0028704081632654277, 0.01661326530612083, 0.04221224489795428],
            [0.002811224489796033, 0.01565714285714139, 0.03801632653060811],
            [0.0026867346938776503, 0.014219387755100869, 0.03270408163264982],
            [0.002467346938775583, 0.012244897959182826, 0.026476530612242703],
            [0.002120408163265337, 0.009618367346938241, 0.019805102040814933],
            [0.0015663265306122148, 0.0064061224489795066, 0.012634693877550465],
            [0.0008275510204081725, 0.0029244897959184064, 0.005060204081632634],
            [1.020408163265306e-05, 1.020408163265306e-05, 1.020408163265306e-05],
        ]
    ),
    "GLDv2-C-Test",
)


# matrix/vit-gldv-similarity-quad_clean/matrix.npy
# training_1/checkpoints/vit-similarity-gldv_quad_clean/cp-0031.ckpt
ViTC = (
    "ViTC",
    np.array(
        [
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31988421e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31986640e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31983077e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31976843e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31967936e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31958138e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31953685e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31942106e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31932309e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31912714e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31888666e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31829882e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31777332e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31686484e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31536851e-02],
            [4.00356268e-04, 3.22351369e-03, 8.31297261e-02],
            [4.00356268e-04, 3.22351369e-03, 8.30932086e-02],
            [4.00356268e-04, 3.22351369e-03, 8.30448452e-02],
            [4.00356268e-04, 3.22342463e-03, 8.29783122e-02],
            [4.00356268e-04, 3.22342463e-03, 8.28733912e-02],
            [4.00356268e-04, 3.22324649e-03, 8.26981964e-02],
            [4.00267201e-04, 3.22297929e-03, 8.23932309e-02],
            [4.00267201e-04, 3.22262302e-03, 8.18402138e-02],
            [4.00178134e-04, 3.22110888e-03, 8.08142507e-02],
            [4.00178134e-04, 3.21816967e-03, 7.86851926e-02],
            [3.99821866e-04, 3.21148965e-03, 7.38666667e-02],
            [3.99287464e-04, 3.18512581e-03, 6.21359163e-02],
            [3.92251169e-04, 2.98739702e-03, 3.22613226e-02],
            [3.91894901e-06, 3.91894901e-06, 3.91894901e-06],
        ]
    ),
    "GLDv2-Test",
)

# clean, test, RNC
# matrix/resnet-similarity-gldv-quad_clean_45_second-test/matrix.npy
RNC = (
    "RNC",
    np.array(
        [
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20295918e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20285714e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20285714e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20285714e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20285714e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20285714e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20255102e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20255102e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20255102e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20244898e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20244898e-02],
            [1.36530612e-03, 7.60306122e-03, 2.20234694e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20214286e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20214286e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20214286e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20204082e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20193878e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20153061e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20132653e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20122449e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20071429e-02],
            [1.36530612e-03, 7.60204082e-03, 2.20040816e-02],
            [1.36530612e-03, 7.60204082e-03, 2.19969388e-02],
            [1.36530612e-03, 7.60204082e-03, 2.19836735e-02],
            [1.36530612e-03, 7.60204082e-03, 2.19724490e-02],
            [1.36530612e-03, 7.60204082e-03, 2.19530612e-02],
            [1.36530612e-03, 7.60204082e-03, 2.19367347e-02],
            [1.36530612e-03, 7.60000000e-03, 2.19163265e-02],
            [1.36530612e-03, 7.59693878e-03, 2.18887755e-02],
            [1.36530612e-03, 7.59489796e-03, 2.18561224e-02],
            [1.36530612e-03, 7.58469388e-03, 2.17959184e-02],
            [1.36428571e-03, 7.57244898e-03, 2.16908163e-02],
            [1.36224490e-03, 7.56020408e-03, 2.15397959e-02],
            [1.35816327e-03, 7.51428571e-03, 2.12530612e-02],
            [1.35612245e-03, 7.46020408e-03, 2.07979592e-02],
            [1.35000000e-03, 7.31530612e-03, 1.99091837e-02],
            [1.33775510e-03, 7.05510204e-03, 1.84408163e-02],
            [1.30102041e-03, 6.50918367e-03, 1.61020408e-02],
            [1.20306122e-03, 5.56224490e-03, 1.27826531e-02],
            [1.00000000e-03, 3.92346939e-03, 8.02448980e-03],
            [5.52040816e-04, 1.54897959e-03, 2.08367347e-03],
            [1.02040816e-05, 1.02040816e-05, 1.02040816e-05],
        ]
    ),
    "GLDv2-C-Test",
)

# clean test vitC
# training_1/checkpoints/vit-similarity-gldv_quad_clean/cp-0031.ckpt
# matrix/vit-gldv-similarity-quad_clean-second-test/matrix.npy
ViTCC = (
    "ViTC",
    np.array(
        [
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89704082e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89693878e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89673469e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89642857e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89612245e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89591837e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89571429e-02],
            [1.50102041e-03, 9.37448980e-03, 2.89500000e-02],
            [1.50102041e-03, 9.37346939e-03, 2.89377551e-02],
            [1.50102041e-03, 9.37142857e-03, 2.89204082e-02],
            [1.50102041e-03, 9.36938776e-03, 2.88826531e-02],
            [1.50102041e-03, 9.36734694e-03, 2.88428571e-02],
            [1.50102041e-03, 9.35714286e-03, 2.87857143e-02],
            [1.50000000e-03, 9.34795918e-03, 2.87020408e-02],
            [1.49795918e-03, 9.32448980e-03, 2.84938776e-02],
            [1.49591837e-03, 9.26326531e-03, 2.79551020e-02],
            [1.48469388e-03, 9.07142857e-03, 2.65346939e-02],
            [1.43265306e-03, 8.19897959e-03, 2.11632653e-02],
            [1.02040816e-05, 1.02040816e-05, 1.02040816e-05],
        ]
    ),
    "GLDv2-C-Test",
)


def get_dataset_size(dataset):
    if dataset == "GLDv2-Test":
        return 499
    if dataset == "GLDv2-C-Test":
        return 49
    if dataset == "MNIST-Test":
        return 891


def find_lowest_decreasing(array):
    # Find the index where the decrease begins
    decreasing_index = None
    for i in range(1, len(array)):
        if array[i] < array[i - 1]:
            decreasing_index = i
            break

    if decreasing_index is None:
        return None  # No decreasing trend found

    # Calculate the threshold value
    threshold_value = array[0] * 0.99  # 3% less than the original value

    # Find the highest index close to the original value
    highest_index = decreasing_index
    for i in range(decreasing_index, len(array)):
        if array[i] < threshold_value:
            break
        highest_index = i

    return highest_index


# Calculate true positives, false positives, and total positives for various thresholds
num_thresholds = 51  # Adjust the number of thresholds
thresholds = np.linspace(0, 1, num_thresholds)
ks = [1, 10, "N"]

colors = ["r", "g", "b", "m", "y", "k", "c"]
linestyles = ["solid", "dashed", "dotted"]

groups = [
    [RN, RNT, RNQR, RNQRC, RNF, RNS, RNC],
    [ViT, ViTT, ViTQR, ViTCC, ViTC],
    [RNN, ViTN],
]
for i, k in enumerate(ks):
    for group in groups:
        plt.figure(figsize=(10, 6))
        for j, pair in enumerate(group):
            plt.plot(
                thresholds,
                pair[1][:, i],
                color=colors[j],
                linestyle=linestyles[0],
                label=pair[0] + " (" + pair[2] + ")",
            )
        plt.xlabel("Slenkstinė vertė")
        plt.ylabel("Metrikos vertė")
        plt.title(f"Recall@{k}")
        plt.legend()
        plt.show()

array = [
    RN,
    RNT,
    RNQR,
    RNS,
    RNQRC,
    RNF,
    RNC,
    ViT,
    ViTT,
    ViTQR,
    ViTC,
    ViTCC,
    RNN,
    ViTN,
]
for i, k in enumerate(ks):
    for j, arr in enumerate(array):
        low = find_lowest_decreasing(arr[1][:, i])
        val = arr[1][:, i][low]
        prc = 0
        ds = get_dataset_size(arr[2])

        if k != "N":
            prc = val / (k / ds) * 100
        else:
            prc = val * 100
        if k == "N":
            v2 = "{:.3f}".format(round(val, 3))
        else:
            v2 = "{:.5f}".format(round(val, 5))

        print(
            arr[0],
            arr[2],
            "{:.2f}".format(round(thresholds[low], 2)),
            v2,
            "{:.0f}".format(round(prc, 0)) + "\% \\\\ \hline",
            sep=" & ",
        )
    print()
